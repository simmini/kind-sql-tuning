# 3장
# 3.2 부분 범위 처리

부분범위 처리는 데이터베이스에서 인덱스를 사용할 대상 레코드가 많을 때 빠른 응답 속도를 유지하는 방법입니다. 이 절에서는 부분범위 처리의 개념, 구현, 그리고 OLTP 환경에서의 성능 개선 원리에 대해 설명합니다.

## 3.2.1 부분 범위 처리

-  **정의**: Fetch Call이 있을 때마다 일정량씩 나누어 데이터를 전송하는 방식입니다.
-  **작동 방식**:
- 클라이언트에서 결정한 Array Size가 10인 상태에서 1건씩 호출할 경우, 10건씩 클라이언트의 캐시에 적재합니다.
- 적재한 데이터를 모두 사용하면 추가 Fetch Call을 통해 10건을 더 요청하고, 이 과정을 반복합니다.
-  **Array Size 조정**:
- 데이터를 끝까지 전송해야 한다면 Array Size를 늘려 Fetch Call을 줄이는 것이 바람직합니다.
- 반대로 데이터를 읽다가 중단하는 경우가 많다면 Array Size를 줄여 불필요한 데이터 전송을 줄이는 것이 좋습니다.
-  **DBMS 지원**: 이러한 부분범위 처리는 대부분의 DBMS에서 수행 가능하지만, Fetch Call을 사용자의 요청에 따라 처리할지, 자동으로 계속 불러올지는 프로그램에 따라 다릅니다.

## 3.2.2 부분범위 처리 구현

부분범위 처리는 특정 조건에 따라 데이터를 나누어 전송하는 방법으로, 구현 방식은 다음과 같습니다:

1. **Fetch Call 설정**: 클라이언트에서 요청할 데이터의 양을 설정합니다 (예: Array Size).
2. **데이터 요청**: 클라이언트는 설정한 양만큼 데이터를 요청합니다.
3. **캐시 적재**: 서버는 요청에 따라 데이터를 클라이언트의 캐시에 적재합니다.
4. **추가 요청**: 클라이언트가 필요한 데이터를 모두 사용한 후, 추가 Fetch Call을 통해 더 많은 데이터를 요청합니다.
5. **반복**: 이 과정을 반복하여 필요한 만큼 데이터를 전송합니다.

## 3.2.3 OLTP 환경에서 부분범위 처리에 의한 성능 개선 원리

-  **OLTP 환경**: 은행 입출금, 게시판, 뉴스 등의 경우 상위 일부 데이터만 처리하는 OLTP 환경에서 부분범위 처리는 성능 개선에 큰 도움이 됩니다.
-  **인덱스 활용**:
- 해당하는 컬럼에 인덱스를 설정하여 항상 정렬 상태를 유지하게 하면, 부분범위 처리가 가능해져 응답 속도가 빨라집니다.
- 예시 쿼리:
  ```sql
  SELECT *
  FROM board
  WHERE code = 'a'
  ORDER BY regit_date DESC;
  ```
- 이 예시에서 인덱스는 `(code, regit_date)`로 설정되어야 하며, 이렇게 하면 정렬 연산을 생략할 수 있어 부분범위 처리가 가능합니다.

### 배치 I/O

-  **정의**: 버퍼 캐시에서 블록을 찾지 못할 경우 발생하는 DISK I/O를 미뤄두었다가 일정량이 쌓이면 한꺼번에 처리하는 방식입니다.
-  **정렬 순서**: 배치 I/O가 작동하면 정렬 순서가 보장되지 않기 때문에, 정렬을 생략할 수 없습니다. 이로 인해 부분범위 처리가 불가능해집니다.

---

이와 같이 부분범위 처리는 데이터베이스 성능을 향상시키기 위한 중요한 기법으로, 적절한 인덱스 설정과 Array Size 조정을 통해 효율적인 데이터 전송을 가능하게 합니다.

